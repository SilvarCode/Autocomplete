/**
 * ***************************************************************************
 *                      SilvarCode/Autocomplete Plugin
 * ***************************************************************************
 * @copyright   2022 SilvarCode / SilvarCode.com
 *              All rights reserved.
 * @link        https://silvarcode.com
 * @since       1.0.0
 * @license     MIT License - see LICENSE.txt for more details.
 *              Redistributions of files must retain the above notice.
 *              https://opensource.org/licenses/mit-license.php MIT License
 *
 */ jQuery(document).ready(function(t){t("input.sc-autocomplete").each(function(){let e=t(this),n=e.attr("id"),i=e.attr("data-url"),a=t.parseJSON(e.attr("data-options"))||"{}",o={},l=t("#"+n+"-show"),r=t("#"+n+"-hidden"),s="multiple"===r.attr("multiple");function u(){let e=r.find("option").toArray(),n=t(e).map(function(){return t(this).val()}).get();l.find("span.autocomplete-selection-item").each(function(){let e=t(this),i=e.find(".remove-button"),a=i.find("i"),o=a.attr("data-hidden-value"),l=-1!==t.inArray(o,n);l||e.remove(),a.on("click",function(){var e;let n=t(this).closest("span.autocomplete-selection-item");e=t(n).find("span.remove-button i").attr("data-hidden-value"),r.find("option").each(function(){t(this).val()===e&&t(this).remove()}),n.remove()})})}function c(e){let n=!1,i;return(i=[],r.find("option").each(function(){i.push(t(this).val())}),i).forEach(function(t){if(e===t){n=!0;return}}),n}function p(){r.find("option").each(function(){t(this).remove()})}function d(){r.find("option").each(function(){t(this).attr("selected","selected")})}d(),u(),e.autocomplete({search:function(t,e){},open:function(){t(this).removeClass("ui-corner-all").addClass("ui-corner-top")},close:function(){t(this).removeClass("ui-corner-top").addClass("ui-corner-all")},select:function(e,n){return c(n.item.value)?(this.value="",!1):(s||p(),r.append(t("<option></option>").attr("value",n.item.value).attr("text",n.item.text).attr("selected","selected")),(span=t('<span class="autocomplete-selection-item"></span>')).append('<span class="text"></span>'),span.append('<span class="remove-button"><i class="fa fa-times remove-icon"></i></span>'),span.find("span.text").html(n.item.label),span.find("span.remove-button i").attr("data-hidden-value",n.item.value),l.append(span),d(),u(),this.value="",!1)},source:function(n,l){var r,u;if(n.term in o){l(o[n.term]);return}s||p();let d;if((searchCurrentItems=(r=n.term,u=a,d=[],t.map(u,function(t){!c(t.value)&&t.text.search(RegExp(r,"gi"))>-1&&(void 0===t.label&&(t.label='<div class="row"><div class="col">'+t.text+"</div></div>"),d.push(t))}),d)).length>0)return o[n.term]=searchCurrentItems,l(t.map(searchCurrentItems,function(t){return t}));(requestOptions={}).url=i,requestOptions.type="GET",requestOptions.data=n,requestOptions.context=null,requestOptions.beforeSend=function(t){e.addClass("autocomplete-loading-input")},t.ajax(requestOptions).done(function(i){i="string"!=typeof i?JSON.stringify(i):i,i=t.parseJSON(i),o[n.term]=i,e.removeClass("autocomplete-loading-input"),l(t.map(i,function(t){return t}))})},minLength:2}).data("ui-autocomplete")._renderItem=function(e,n){var i,a;let o="<div>"+(i=n.label,a=this.term,i=String(i),a=String(a),t(i).text().replace(RegExp(a,"gi"),"<strong>$&</strong>"))+"</div>";return t("<li></li>").data("ui-autocomplete-item",n).append(o).appendTo(e)}})});